<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <script>
      window.__CP_DEBUG = {{ CP_DEBUG|tojson }};
      if (!window.__CP_DEBUG) { try { console.debug = function(){} } catch(e){} }
    </script>
    <title>Leaderboard</title>
    <link href="/static/vendor/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/site.css" />
    <style>
      .leaderboard-table { max-width: 800px; }
    </style>
  </head>
  <body class="p-4">
    {% include '_ribbon.html' %}

    <div class="container py-4">
      <h1 class="h4 mb-3">Leaderboard</h1>
      <div class="leaderboard-table">
        <table class="table table-striped">
          <thead>
            <tr><th>Rank</th><th>Username</th><th>XP</th></tr>
          </thead>
          <tbody id="leaderboardBody">
            <tr><td colspan="3">Loading...</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <script src="/static/vendor/jquery-3.6.0.min.js"></script>
    <script>window.jQuery = window.jQuery || window.$; window.$ = window.$ || window.jQuery;</script>
  <script src="/static/vendor/bootstrap.bundle.min.js"></script>
    <script src="/static/js/ribbon.js"></script>
    <script>window.addEventListener('DOMContentLoaded', ()=>{ if (window.initRibbon) window.initRibbon();
        // fetch leaderboard
        fetch('/leaderboard').then(r=>r.json()).then(data=>{
          const body = document.getElementById('leaderboardBody');
          body.innerHTML = '';
          if (!data || !data.items || data.items.length===0) {
            body.innerHTML = '<tr><td colspan="3">No entries</td></tr>';
            return;
          }
          data.items.forEach((it, idx)=>{
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${idx+1}</td><td>${it.username}</td><td>${it.xp}</td>`;
            body.appendChild(tr);
          });
        }).catch(e=>{ const body = document.getElementById('leaderboardBody'); body.innerHTML = '<tr><td colspan="3">Failed to load</td></tr>'; });
      })</script>
  </body>
</html>
