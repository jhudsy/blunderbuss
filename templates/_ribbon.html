<!-- Shared ribbon partial: shows XP, streak, navigation, and user info -->
<div class="container-fluid bg-light py-2 mb-3">
  <style>
    .ribbon-pulse{animation: ribbonPulse 0.9s ease-in-out;}
    @keyframes ribbonPulse{0%{transform:scale(1);}50%{transform:scale(1.25);}100%{transform:scale(1);}}
  </style>
  <div class="container d-flex justify-content-between align-items-center">
    <div>
  <span class="me-3">XP: <strong id="ribbonXP">-</strong></span>
  <span class="me-3" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Day streak: how many days in a row you've attempted puzzles. Keep it going!">Days: <strong id="ribbonDaysStreak">-</strong></span>
  <span class="me-3" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Puzzle streak: how many puzzles in a row you've answered correctly. The first number is your current streak, and the number in brackets is your best ever streak. Nice work!">Puzzle: <strong id="ribbonPuzzleStreak">-</strong></span>
    </div>
    <div>
      {% set cur = request.path %}
      {% set puzzle_url = url_for('puzzle_page') %}
      {% set leaderboard_url = url_for('leaderboard_page') %}
      {% set settings_url = url_for('settings') %}
      {% set badges_url = url_for('badge_gallery') %}
      {% set about_url = url_for('about_page') %}
      {% if cur != about_url %}
        <a class="btn btn-sm btn-outline-secondary me-2" href="{{ about_url }}">About</a>
      {% endif %}
      {% if cur != puzzle_url %}
        <a class="btn btn-sm btn-outline-secondary me-2" href="{{ puzzle_url }}">Back to Puzzles</a>
      {% endif %}
      {% if cur != leaderboard_url %}
        <a class="btn btn-sm btn-outline-secondary me-2" href="{{ leaderboard_url }}">Leaderboard</a>
      {% endif %}
      {% if cur != settings_url %}
        <a class="btn btn-sm btn-outline-secondary me-2" href="{{ settings_url }}">Settings</a>
      {% endif %}
      {% if session.username %}
        <button id="ribbonUpdatePuzzles" class="btn btn-sm btn-success me-2">Update puzzles</button>
      {% endif %}
      {# Badges button removed: badge count link leads to /badges now #}
    </div>
    <div class="d-flex align-items-center">
      <span id="ribbonUsername">{% if session.username %}{{ session.username }}{% else %}Not signed in{% endif %}</span>
      <a class="ms-3 me-2" href="{{ badges_url }}" title="View badges" style="display:inline-flex;align-items:center">
        <img src="/static/img/badges/default.svg" alt="badges" style="width:20px;height:20px;margin-right:6px;border-radius:4px"> <span id="ribbonBadgeCount" class="badge bg-secondary">0</span>
      </a>
      {% if session.username %}
        <a id="ribbonAuth" class="btn btn-sm btn-primary ms-2" href="/logout">Logout</a>
      {% else %}
        <a id="ribbonAuth" class="btn btn-sm btn-primary ms-2" href="/login">Login</a>
      {% endif %}
    </div>
  </div>
</div>

    <!-- Import modal: shown when updating puzzles -->
    <div class="modal fade" id="importModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Updating puzzles</h5>
          </div>
          <div class="modal-body text-center">
            <div id="importSpinner" class="mb-2">
              <div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>
            </div>
            <div id="importProgress">Imported <strong id="importDone">0</strong></div>
            <div id="importLast">Last game: <span id="importLastGame">-</span></div>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/js/importer.js"></script>
